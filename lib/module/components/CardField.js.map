{"version":3,"sources":["CardField.tsx"],"names":["CardFieldNative","CardField","ref","onCardChange","onFocus","onBlur","cardStyle","placeholder","postalCodeEnabled","props","inputRef","onCardChangeHandler","event","card","nativeEvent","data","last4","expiryMonth","expiryYear","complete","brand","cvc","hasOwnProperty","postalCode","number","__DEV__","console","warn","onFocusHandler","focusedField","current","focus","UIManager","dispatchViewManagerCommand","blur","clear","inputRefValue","backgroundColor","borderColor","borderWidth","borderRadius","cursorColor","fontSize","placeholderColor","textColor","textErrorColor","fontFamily","expiration"],"mappings":"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","sourcesContent":["import type { CardFieldInput, Nullable } from '../types';\nimport React, {\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useLayoutEffect,\n  useRef,\n} from 'react';\nimport {\n  AccessibilityProps,\n  NativeSyntheticEvent,\n  requireNativeComponent,\n  UIManager,\n  StyleProp,\n  findNodeHandle,\n  ViewStyle,\n} from 'react-native';\nimport {\n  currentlyFocusedInput,\n  focusInput,\n  registerInput,\n  unregisterInput,\n} from '../helpers';\n\nconst CardFieldNative =\n  requireNativeComponent<CardFieldInput.NativeProps>('CardField');\n\n/**\n *  Card Field Component Props\n */\nexport interface Props extends AccessibilityProps {\n  style?: StyleProp<ViewStyle>;\n  postalCodeEnabled?: boolean;\n  cardStyle?: CardFieldInput.Styles;\n  placeholder?: CardFieldInput.Placeholders;\n  autofocus?: boolean;\n  onCardChange?(card: CardFieldInput.Details): void;\n  onBlur?(): void;\n  onFocus?(focusedField: Nullable<CardFieldInput.Names>): void;\n  testID?: string;\n  /**\n   * WARNING: If set to `true` the full card number will be returned in the `onCardChange` handler.\n   * Only do this if you're certain that you fulfill the necessary PCI compliance requirements.\n   * Make sure that you're not mistakenly logging or storing full card details!\n   * See the docs for details: https://stripe.com/docs/security/guide#validating-pci-compliance\n   */\n  dangerouslyGetFullCardDetails?: boolean;\n}\n\n/**\n *  Card Field Component\n *\n * @example\n * ```ts\n * <CardField\n *    postalCodeEnabled={false}\n *    onCardChange={(cardDetails) => {\n *    console.log('card details', cardDetails);\n *      setCard(cardDetails);\n *    }}\n *    style={{height: 50}}\n *  />\n * ```\n * @param __namedParameters Props\n * @returns JSX.Element\n * @category ReactComponents\n */\nexport const CardField = forwardRef<CardFieldInput.Methods, Props>(\n  (\n    {\n      onCardChange,\n      onFocus,\n      onBlur,\n      cardStyle,\n      placeholder,\n      postalCodeEnabled,\n      ...props\n    },\n    ref\n  ) => {\n    const inputRef = useRef<any>(null);\n\n    const onCardChangeHandler = useCallback(\n      (event: NativeSyntheticEvent<CardFieldInput.Details>) => {\n        const card = event.nativeEvent;\n\n        const data: CardFieldInput.Details = {\n          last4: card.last4,\n          expiryMonth: card.expiryMonth,\n          expiryYear: card.expiryYear,\n          complete: card.complete,\n          brand: card.brand,\n          cvc: card.cvc,\n        };\n\n        if (card.hasOwnProperty('postalCode')) {\n          data.postalCode = card.postalCode || '';\n        }\n        if (card.hasOwnProperty('number')) {\n          data.number = card.number || '';\n          if (__DEV__ && onCardChange && card.complete) {\n            console.warn(\n              `[stripe-react-native] ⚠️ WARNING: You've enabled \\`dangerouslyGetFullCardDetails\\`, meaning full card details are being returned. Only do this if you're certain that you fulfill the necessary PCI compliance requirements. Make sure that you're not mistakenly logging or storing full card details! See the docs for details: https://stripe.com/docs/security/guide#validating-pci-compliance`\n            );\n          }\n        }\n        onCardChange?.(data);\n      },\n      [onCardChange]\n    );\n\n    const onFocusHandler = useCallback(\n      (event) => {\n        const { focusedField } = event.nativeEvent;\n        if (focusedField) {\n          focusInput(inputRef.current);\n          onFocus?.(focusedField);\n        } else {\n          onBlur?.();\n        }\n      },\n      [onFocus, onBlur]\n    );\n\n    const focus = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'focus' as any,\n        []\n      );\n    };\n\n    const blur = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'blur' as any,\n        []\n      );\n    };\n\n    const clear = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'clear' as any,\n        []\n      );\n    };\n\n    useImperativeHandle(ref, () => ({\n      focus,\n      blur,\n      clear,\n    }));\n\n    useLayoutEffect(() => {\n      const inputRefValue = inputRef.current;\n      if (inputRefValue !== null) {\n        registerInput(inputRefValue);\n        return () => {\n          unregisterInput(inputRefValue);\n          if (currentlyFocusedInput() === inputRefValue) {\n            inputRefValue.blur();\n          }\n        };\n      }\n      return () => {};\n    }, [inputRef]);\n\n    return (\n      <CardFieldNative\n        ref={inputRef}\n        onCardChange={onCardChangeHandler}\n        onFocusChange={onFocusHandler}\n        postalCodeEnabled={postalCodeEnabled ?? true}\n        cardStyle={{\n          backgroundColor: cardStyle?.backgroundColor,\n          borderColor: cardStyle?.borderColor,\n          borderWidth: cardStyle?.borderWidth,\n          borderRadius: cardStyle?.borderRadius,\n          cursorColor: cardStyle?.cursorColor,\n          fontSize: cardStyle?.fontSize,\n          placeholderColor: cardStyle?.placeholderColor,\n          textColor: cardStyle?.textColor,\n          textErrorColor: cardStyle?.textErrorColor,\n          fontFamily: cardStyle?.fontFamily,\n        }}\n        placeholder={{\n          number: placeholder?.number,\n          expiration: placeholder?.expiration,\n          cvc: placeholder?.cvc,\n          postalCode: placeholder?.postalCode,\n        }}\n        {...props}\n      />\n    );\n  }\n);\n"]}